<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RNG Frequency</title>
</head>
<body>
  <h1>Real RNG Frequency</h1>
  <p>Previous: <span id="previous"></span></p>
  <p>Final: <span id="final"></span></p>
  <p>Next round in: <span id="timer"></span> sec</p>

  <script>
    let roundStart = Date.now();

    async function fetchNumber() {
      const res = await fetch("/api/number");
      return res.json();
    }

    async function runRound() {
      const now = new Date();
      const sec = now.getSeconds();

      if (sec === 25) {
        const data = await fetchNumber();
        document.getElementById("previous").innerText = data.finalNum;
      }

      if (sec === 0) {
        const data = await fetchNumber();
        document.getElementById("final").innerText = data.finalNum;
      }

      // Countdown
      const next = 60 - sec;
      document.getElementById("timer").innerText = next;
    }

    setInterval(runRound, 1000);
  </script>
</body>
</html>
